**You do NOT need to translate anything.**
**Focus purely on CONTENT SELECTION - identifying the best expressions.**
**Use INDICES to reference dialogues, not timestamps or text.**

---

Here is a segment of dialogue from the TV show "{show_name}":

**SOURCE DIALOGUES ({source_language}):**
---
{source_dialogues}
---

**TARGET DIALOGUES ({target_language}):**
---
{target_dialogues}
---

**INPUT FORMAT:**
Each dialogue line is formatted as: `[index] dialogue_text`
Use these indices in your output to reference specific dialogues.
The system will look up actual text and timestamps from the indices you provide.

---

**‚ö†Ô∏è CRITICAL LANGUAGE REQUIREMENT:**
- The **catchy_keywords** field MUST BE 100% IN {target_language}. NEVER WRITE {source_language} KEYWORDS.
- The **title** field MUST BE 100% IN {target_language}. NEVER WRITE {source_language} TITLES.
- The **intro_hook** field MUST BE 100% IN {target_language}.
- ‚ùå WRONG: {source_language} keywords, titles, or hooks
- ‚úÖ CORRECT: {target_language} keywords, titles, and hooks

---

**YOUR MISSION:**
Find the best expressions from the {source_language} dialogues that learners would be EXCITED to learn - expressions they'd actually use and remember.

**CRITICAL: FOCUS ON HIGH-ENERGY, MEMORABLE MOMENTS**
When selecting expressions, prioritize scenes with strong emotional impact or entertainment value. The best expressions often come from moments that are:
- **üòÇ HUMOROUS:** Funny, witty, sarcastic, or laugh-out-loud moments.
- **üî• INTENSE/DRAMATIC:** High tension, conflict, confrontation, or high stakes.
- **üòç SEXY/ROMANTIC:** Flirty, charming, or romantically charged interactions.
- **üò≤ SURPRISING:** Unexpected twists or reveals that grab attention.

Think about what would make a short video clip go viral. If the scene makes you laugh, gasp, or feel something strong, it's a prime candidate.

**IMPORTANT:** You can extract UP TO {max_expressions} expressions from this dialogue segment.
Choose the BEST expressions - prioritize quality over filling the quota.
Each expression should come from a DIFFERENT, NON-OVERLAPPING index range.
If there aren't enough high-quality expressions, it's OK to return fewer.

**LANGUAGE LEVEL:** {level_description}

---

**THE NORTH STAR PRINCIPLE:**
Ask yourself: "Would I be excited to share THIS clip with a friend because it's hilarious, intense, or awesome?"

If the answer is YES because:
- ‚úì It's a scene that grabs attention (funny/dramatic/sexy/tense)
- ‚úì The expression is used naturally in this high-energy moment
- ‚úì It's memorable because of the scene's impact
- ‚úì Learners would actually say this in their daily life

Then it's worth extracting.

If the answer is NO because:
- ‚úó The scene is boring, flat, or procedural
- ‚úó It's too obvious or simple
- ‚úó It's too specific to this one situation
- ‚úó It's awkward phrasing or too formal/legal jargon

Then skip it.

---

**WHAT MAKES AN EXPRESSION "BEST":**

**1. HIGH-IMPACT SCENE** (Crucial for engagement)
The expression appears in a scene that is:
- Humorous, dramatic, tense, emotional, sexy, or witty
- NOT boring procedural talk or flat information delivery
- Has energy and personality that makes the clip highly watchable
- Makes the expression memorable through emotion or entertainment

**2. COMMON & REUSABLE**
- Used frequently by native speakers across different situations
- Not tied to just legal/office settings - can be used in everyday life
- Something you'd hear in conversations, movies, casual settings
- Test: "Would native speakers use this expression at least once a week?"
- **COMPLEXITY REQUIREMENT:** The expression should be substantial enough to be worth learning:
  * Multi-word phrases (3+ words preferred): "get on my nerves", "blow off steam", "cut to the chase"
  * Phrasal verbs with interesting usage: "put up with", "come up with", "figure out"
  * NOT simple curses or basic 1-2 word phrases: avoid "bullshit", "screw you", "damn it"
  * The expression should have a non-obvious meaning or usage pattern

**3. CLEARLY USEFUL**
- Idiomatic expressions, phrasal verbs, or colloquial phrases
- Not just regular vocabulary or obvious statements
- Appropriate for your target level: {level_description}

---

**STRICT FILTERS - NEVER EXTRACT:**
- ‚úó Plain statements with no special expression ("I agree", "That's good")
- ‚úó Scene-specific phrases that only work in this exact context
- ‚úó Overly formal legal jargon (unless it's commonly used in general conversation)
- ‚úó Random sentence fragments that aren't actual expressions
- ‚úó Boring exchanges with no emotional energy
- ‚úó Expressions that are self-explanatory and obvious

---

**UNDERSTANDING THE STORY FIRST:**

Before extracting expressions, take time to understand:
1. **What's the emotional hook?** - Is it funny? Tense? Sexy? Dramatic?
2. **What's happening in this scene?** - The situation, conflict, or interaction
3. **Who are the characters?** - Their relationships and motivations
4. **Why does this moment matter?** - What makes it interesting or memorable?

This understanding will help you:
- Select the most engaging expressions from high-impact scenes
- Provide context that tells a compelling mini-story
- Generate catchy keywords that capture the scene's energy

---

**CONTEXT DESIGN - TELL A MINI-STORY:**

**GOAL:** Learners should be enthralled by the story segment AND learn the expression naturally.

**CRITICAL PRINCIPLES:**

1. **LONGER, STORY-RICH CONTEXT (25-45 seconds typical)**
   - Give enough dialogue to understand WHO these people are and WHAT'S happening
   - Include the setup that makes the expression make sense and builds tension/humor
   - Include reactions that show the impact or meaning
   - Let viewers follow the narrative flow naturally

2. **EXPRESSION PLACEMENT:**
   - The expression should appear naturally in the middle of the story
   - NOT at the very beginning (needs setup)
   - NOT at the very end (needs reaction/closure)

3. **COMPLETE STORY ARC:**
   - **Beginning:** Establish situation/conflict/hook
   - **Middle:** Expression appears in context
   - **End:** Reaction/response that completes the moment

4. **START AND END POINTS (using indices):**
   - **context_start_index:** Begin when the situation/topic begins (complete sentence)
   - **context_end_index:** End when the moment feels complete and resolved (complete sentence)
   - **Include full sentences at boundaries** - no partial phrases

**LENGTH GUIDELINES:**
- **Target Duration:** Aim for a context of approximately **{target_duration} seconds** total
- **Minimum:** {target_duration} - 15 seconds (for shorter scenes)
- **Maximum:** {target_duration} + 15 seconds (if needed for story completion)
- **IMPORTANT:** Each extracted context WILL become a standalone short video

**Quick Test:**
- Can someone who's never seen the show understand what's happening?
- Does it feel like a complete, engaging mini-scene?
- Would learners enjoy watching this clip just for the entertainment value?
- Is the expression's usage crystal clear from the context?

---

**CRITICAL: NO OVERLAPPING CLIPS - CREATE A CONTINUOUS VIEWING EXPERIENCE**

**THE BIG PICTURE:**
When all extracted clips are played in chronological order, learners should be able to watch the entire episode naturally - like watching a movie with no repeated scenes. Each clip should pick up where the previous one left off or jump forward in the story.

**ABSOLUTE RULES:**

1. **ZERO OVERLAP BETWEEN CLIPS:**
   - If you extract multiple expressions from DIFFERENT dialogue segments, their index ranges must NEVER overlap
   - Previous clip ends at index X ‚Üí Next clip must start at index X or later
   - Example: 
     * Clip 1: context_start_index=2, context_end_index=8 ‚úì
     * Clip 2: context_start_index=9, context_end_index=15 ‚úì (starts after Clip 1 ended)
     * Clip 2: context_start_index=6, context_end_index=12 ‚úó (overlaps with Clip 1 - NEVER DO THIS)

2. **CHRONOLOGICAL STORY FLOW:**
   - Extract expressions in the order they appear in the dialogue
   - Each new clip should advance the story forward
   - Learners should feel they're watching the episode unfold naturally
   - Gaps between clips are OK (story jumps forward)
   - Overlaps are NOT OK (story repeats itself)

3. **CONTEXT BOUNDARIES MUST NOT OVERLAP:**
   - **CRITICAL:** Different contexts must NEVER overlap
   - Before finalizing your selection, review all `context_start_index` and `context_end_index` values
   - Sort contexts chronologically by `context_start_index`
   - Verify that each context's start index is > previous context's end index
   - If you find ANY overlap between different contexts, adjust or remove one of them

**VERIFICATION CHECKLIST:**
- ‚úì All clips are sorted by start index (lowest to highest)
- ‚úì No clip's start index is ‚â§ a previous clip's end index
- ‚úì Together, clips tell a forward-moving story with no repetition
- ‚úì If clips are back-to-back, they feel like one continuous scene
- ‚úì If there are gaps, they feel like natural story progression (time jump forward)

---

**CATCHY CONTEXT KEYWORDS - HOOK THE VIEWER:**

**PURPOSE:** Generate short, punchy phrases in {target_language} that make people think "Wait, WHAT? I need to see this!" within 2-3 seconds. These should feel like engaging social media captions.

**CHARACTERISTICS OF GREAT KEYWORDS:**

1. **REVEAL THE JUICY PART & EMOTION** without spoiling everything
   - Hint at conflict, surprise, drama, humor, or romance
   - Create curiosity: "How did THAT happen?" or "Did they just say that?"

2. **FOCUS ON THE UNEXPECTED & HIGH STAKES**
   - What's surprising, unusual, or highly relatable about this scene?
   - What would make someone stop scrolling immediately?
   - What's the dramatic "hook" that makes this moment special?

3. **USE POWER WORDS & STRONG VERBS**
   - Words that create emotion: Awesome, Shocking, Plot twist, Fluttering, Crisis, Secret, Hysterical
   - Action words: Ram into, Confess, Get caught, Explode, Confront
   - Dramatic words: Truth, Decision, Choice, Worst case scenario

4. **DIFFERENT ANGLES** for the same scene:
   - Keyword 1: Character/Relatable perspective
   - Keyword 2: Conflict/Drama angle
   - Keyword 3: Humor/Situation

**FORMAT:**
- Each keyword: 3-6 words in {target_language}
- NO full sentences, NO explanations
- Short, punchy, scroll-stopping
- Think: "TikTok/Reel caption style" - colloquial, engaging, maybe slightly provocative

**BAD EXAMPLES (too bland):**
- ‚ùå "Scene of an interview" (too descriptive, no hook)
- ‚ùå "Conversation at a law firm" (too generic)
- ‚ùå "Mike and Harvey meeting" (no drama)

**PROCESS:**
1. Identify what's dramatic/surprising/emotional/funny about this scene
2. Brainstorm 5-6 possible angles, focusing on the hook
3. Pick the top 2-3 that would make YOU click/watch
4. Keep them short and punchy

---

**EXTRACTING THE EXPRESSION - GIVE MORE CONTEXT:**

**NEW APPROACH: Expand the phrase to include meaningful context**

Instead of extracting just the bare minimum phrase, include enough surrounding words to make the expression's usage pattern clear and natural.

**EXAMPLES:**

‚ùå TOO SHORT (old way):
- "figure out"
- "deal with"
- "come up with"

‚úÖ BETTER (new way - includes usage context):
- "figure out what to do"
- "deal with this situation"
- "come up with a solution"
- "I can't deal with this right now"
- "We need to figure out how to handle this"

**GUIDELINES:**
- Include the verb AND its natural object/complement when relevant
- Include necessary prepositions or particles that show usage
- Include subject pronouns if they're part of the natural usage pattern
- Make it a chunk that learners can memorize and reuse
- Still focus on the KEY phrase, but give it breathing room

**BALANCE:**
- Don't make it so long it becomes a full sentence
- Don't make it so short it's unclear how to use it
- Aim for 4-8 words typically

**EXPRESSION COUNT:**
- Find {min_expressions} to {max_expressions} expressions from this dialogue segment
- Each expression MUST have a DIFFERENT, NON-OVERLAPPING context index range
- Quality over quantity: Only extract expressions that pass ALL quality checks
- It's OK to return fewer than {max_expressions} if there aren't enough high-quality expressions

---

**VOCABULARY ANNOTATIONS - DYNAMIC WORD HIGHLIGHTS:**

**PURPOSE:** Identify 2-5 interesting/difficult vocabulary words from the {source_language} dialogues that will appear as dynamic overlays when spoken.

**WHAT TO ANNOTATE:**
- ‚úì Slang terms (e.g., "douchebag", "busted", "screw over")
- ‚úì Idioms within the dialogue (e.g., "off the hook", "on the same page")
- ‚úì Culturally-specific terms that need explanation
- ‚úì Difficult words for intermediate learners
- ‚úì Words that add color/meaning to the scene

**WHAT NOT TO ANNOTATE:**
- ‚úó The main expression itself (that's shown separately)
- ‚úó Common words everyone knows ("the", "is", "good")
- ‚úó Words that are self-explanatory from context

**FORMAT (V2 - NO translation field):**
```json
"vocabulary_annotations": [
  {{"word": "douchebag", "dialogue_index": 0}},
  {{"word": "code red", "dialogue_index": 5}}
]
```

**DIALOGUE_INDEX:** The index of the dialogue line where this word appears (from the numbered input).

---

**PROCESS:**

**STEP 0:** Read and understand the entire scene from BOTH source and target dialogues
   - What's the story here?
   - Who are these people and what do they want?
   - What's the emotion, tension, humor, or hook?

**STEP 1:** Scan the {source_language} dialogues for expressions that pass the North Star test, focusing on high-impact moments.

**STEP 2:** Rank them by:
   1. How engaging and high-energy the scene is (Humor/Drama/Tension/Sexy)
   2. How common/reusable the expression is
   3. How appropriate for the target level

**STEP 3:** For each top expression, design story-rich context using indices:
   - Plan 25-45 seconds that tells a complete mini-story
   - Ensure the expression appears naturally in the middle
   - Verify learners can follow what's happening and feel the impact

**STEP 4:** Select UP TO {max_expressions} expressions with NON-OVERLAPPING index ranges. Quality over quantity.

---

**OUTPUT FORMAT (JSON):**

**IMPORTANT: You are a SCRIPT SELECTOR. You do NOT translate. You only select indices that reference the dialogues above.**
The system will look up actual dialogue text and translations from the provided subtitles.

```json
{{
  "expressions": [
    {{
      "title": "Catchy, dramatic title in {target_language} (8-15 words)",
      "expression": "the key phrase from {source_language} (4-8 words copy exactly from source dialogue)",
      "expression_translation": "natural translation of the expression in {target_language}",
      "expression_dialogue_index": 5,
      "context_start_index": 2,
      "context_end_index": 8,
      "catchy_keywords": [
        "keyword 1 in {target_language} (3-6 words)",
        "keyword 2 in {target_language} (3-6 words)",
        "keyword 3 in {target_language} (3-6 words)"
      ],
      "vocabulary_annotations": [
        {{"word": "interesting {source_language} word", "translation": "translation in {target_language}", "dialogue_index": 3}}
      ],
      "similar_expressions": ["alternative 1 in {source_language}", "alternative 2 in {source_language}"],
      "scene_type": "humor|drama|tension|emotional|witty|confrontation|sexy|surprising",
      "intro_hook": "Short, engaging hook in {target_language}"
    }}
  ]
}}
```

---

**FIELD EXPLANATIONS:**

- **title**: Catchy title in {target_language} that makes viewers curious (8-15 words)
- **expression**: Copy the KEY PHRASE exactly from {source_language} dialogue at expression_dialogue_index (4-8 words)
- **expression_translation**: Natural translation of the expression in {target_language}
- **expression_dialogue_index**: Index of the source dialogue line containing the expression
- **context_start_index**: Starting index for context (first line of context)
- **context_end_index**: Ending index for context (last line of context)
- **catchy_keywords**: 2-3 short, punchy keywords in {target_language} (3-6 words each)
- **vocabulary_annotations**: Interesting words with translation in {target_language} and dialogue_index
- **similar_expressions**: 2-3 alternative expressions in {source_language}
- **scene_type**: Category of the scene's energy
- **intro_hook**: Short hook question/statement in {target_language}

**NOTE:** The system will automatically:
1. Look up dialogue text from source_dialogues using your indices
2. Look up dialogue translations from target_dialogues using your indices (if available)
3. Extract timestamps from the indexed dialogues
4. Build the full ExpressionAnalysis object

You do NOT need to include: dialogues[], translation[], expression_dialogue, expression_dialogue_translation, context_start_time, context_end_time.

**IMPORTANT:** You MUST provide: expression_translation and vocabulary_annotations with translation field.

---

**FINAL CHECKLIST:**
- ‚úì You UNDERSTAND the story and situation before extracting
- ‚úì Each expression is COMMON and REUSABLE in real life
- ‚úì Each expression is SUBSTANTIAL (3+ words)
- ‚úì Expression is copied exactly from the source dialogue (4-8 words typical)
- ‚úì Each scene is ENGAGING, HIGH-ENERGY
- ‚úì Indices are valid (within the range of provided dialogues)
- ‚úì Context indices define a cohesive story segment (25-45 seconds)
- ‚úì Expression appears BETWEEN context_start_index and context_end_index
- ‚úì All `catchy_keywords`, `title`, and `intro_hook` are in {target_language}
- ‚úì All `similar_expressions` and `expression` are in {source_language}
- ‚úì NO simple curses or 1-2 word phrases

Return ONLY expressions that pass ALL checks. Quality over quantity.

**CRITICAL: Respond with ONLY valid JSON. No markdown, no explanations.**

If you find expressions, respond with the JSON object.
If you find NO expressions: {{"expressions":[]}}