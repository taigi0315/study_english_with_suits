name: expression_analysis_prompt
version: "8.0"
description: Content selector prompt for extracting expressions from TV show dialogues

prompt: |
  =**CONTENT SELECTOR for "{show_name}"**

  **SOURCE DIALOGUES ({source_language}):**
  {source_dialogues}

  **TARGET DIALOGUES ({target_language}):**
  {target_dialogues}

  **Format:** `[index] dialogue_text` - Use indices to reference dialogues.

  ---

  **âš ï¸ LANGUAGE RULES:**
  - `catchy_keywords`, `narrations`, `intro_hook`, `title_translation` â†’ {target_language}
  - `title`, `expression`, `similar_expressions` â†’ {source_language}
  - All `translation` fields â†’ {target_language}

  ---

  **MISSION:** Find {min_expressions}-{max_expressions} expressions learners would be EXCITED to learn.

  **LEVEL:** {level_description}

  ---

  **WHAT TO EXTRACT:**

  âœ… **HIGH-IMPACT SCENES:**
  - ğŸ˜‚ Humorous/witty moments
  - ğŸ”¥ Dramatic/tense confrontations  
  - ğŸ˜ Romantic/flirty interactions
  - ğŸ˜² Surprising reveals

  âœ… **REUSABLE EXPRESSIONS (3+ words):**
  - Phrasal verbs: "put up with", "figure out what to do"
  - Idioms: "cut to the chase", "get on my nerves"
  - Colloquial phrases: "no big deal", "you bet"
  - **âš ï¸ MUST BE CONTEXT-FREE:** Expression should make sense WITHOUT knowing the drama/scene
  - Test: Would native speakers use this weekly in everyday life?

  âŒ **NEVER EXTRACT:**
  - Boring/procedural dialogue
  - Simple curses or 1-2 word phrases ("bullshit", "damn")
  - **Scene-specific phrases that only work in this drama's context**
  - Self-explanatory statements ("I agree", "That's good")
  - Expressions that require knowing what happened in the scene

  ---

  **CONTEXT DESIGN:**

  **Goal:** Each clip = standalone mini-story (25-45 seconds, ~{target_duration}s target)

  **Structure:**
  - **Beginning:** Setup situation/conflict
  - **Middle:** Expression appears naturally
  - **End:** Reaction/resolution

  **Rules:**
  - Expression should NOT be at very start or end
  - Include complete sentences at boundaries
  - **ZERO OVERLAP** between different clips' index ranges

  ---

  **TITLE:**
  The iconic, meme-worthy quote from the scene in {source_language}. should be narrative can hook the audience.

  **Good examples:**
  - "ë‹ˆê¹Œì§“ ê²Œ ë‚  ì£½ì—¬?" (The Glory)
  - "I don't have dreams, I have goals." (Suits)
  - "ì—°ì§„ì•„, ì´ê±° ëˆ„êµ¬ ë”¸ì´ë‹ˆ?"

  **Characteristics:** 3-12 words, quotable, makes people click/share.

  ---

  **NARRATIONS (3-6 per clip):**

  Timestamped commentary in {target_language} throughout the video. Displayed separately from subtitles.

  âš ï¸ **CRITICAL: Narrations MUST be written 100% in {target_language} ONLY!**
  - âŒ WRONG: "Aprende 'ì‚¬íšŒì  ì•½ì' (socialmente vulnerable)" - Contains {source_language}!
  - âŒ WRONG: "Learn 'ë‚´ ê¿ˆì€ ë„ˆì•¼' here" - Contains {source_language}!
  - âœ… CORRECT: "Â¡Una frase muy Ãºtil para expresar tus sueÃ±os!" - Pure {target_language}
  - âœ… CORRECT: "Esta expresiÃ³n se usa cuando quieres vengarte" - Pure {target_language}

  **DO NOT include any {source_language} words, even in quotes. Write EVERYTHING in {target_language}.**

  **Types:**
  | Type | Purpose | What it does |
  |------|---------|--------------|
  | `hook` | Opening attention grab | Get viewer's attention at the start |
  | `highlight` | Point out key expressions | Explain why this phrase is useful |
  | `reaction` | Comment on scene/acting | React to dramatic moments |
  | `tension` | Build suspense | Create anticipation |
  | `commentary` | Relatable observation | Connect with viewers |

  **Guidelines:**
  - Write in casual, conversational {target_language}
  - 5-15 words each
  - Space them out - don't narrate every line
  - Match scene energy (funny scene = funny narration)

  ---

  **ANNOTATIONS:**

  **vocabulary_annotations** - Single difficult WORDS:
  ```json
  {{"word": "leverage", "translation": "ì˜í–¥ë ¥", "dialogue_index": 5}}
  ```

  **expression_annotations** - Multi-word IDIOMS/PHRASES:
  ```json
  {{"expression": "cut to the chase", "translation": "ë³¸ë¡ ìœ¼ë¡œ ë“¤ì–´ê°€ë‹¤", "dialogue_index": 7}}
  ```

  **âš ï¸ CRITICAL: ZERO OVERLAP between vocabulary and expression annotations.**
  Both display on same visual layer - overlapping = unreadable subtitles.

  âŒ Bad: vocabulary "rat" + expression "rat me out"
  âœ… Good: vocabulary "leverage" + expression "cut to the chase"

  ---

  **CATCHY KEYWORDS (3 per clip):**

  Short, punchy phrases in {target_language} for social media hooks.

  **Format:** 3-6 words each, TikTok caption style

  **Good:** "ë©´ì ‘ì¥ íŒ¨ê¸° í­ë°œ", "ì†Œë¦„ë‹ëŠ” ì²«ë§ˆë””", "ìƒì‚¬í•œí…Œ ì§êµ¬ ë‚ ë¦¼"
  **Bad:** "Scene of an interview", "ë‘ ì‚¬ëŒì´ ëŒ€í™”í•¨"

  ---

  **OUTPUT FORMAT (JSON only):**

  ```json
  {{
    "expressions": [
      {{
        "title": "Catchy title in {source_language} - meme-worthy quote (8-15 words)",
        "title_translation": "natural translation in {target_language}",
        "expression": "key phrase copied exactly from dialogue (4-8 words)",
        "expression_translation": "LITERAL translation (ì§ì—­) in {target_language} - word-by-word, no context",
        "expression_dialogue_index": 5,
        "context_start_index": 2,
        "context_end_index": 12,
        "narrations": [
          {{"dialogue_index": 2, "text": "Hook text", "type": "hook"}},
          {{"dialogue_index": 5, "text": "Highlight text", "type": "highlight"}},
          {{"dialogue_index": 8, "text": "Reaction text", "type": "reaction"}},
          {{"dialogue_index": 11, "text": "Tension text", "type": "tension"}}
        ],
        "catchy_keywords": ["keyword 1", "keyword 2", "keyword 3"],
        "vocabulary_annotations": [
          {{"word": "word", "translation": "ë²ˆì—­", "dialogue_index": 3}}
        ],
        "expression_annotations": [
          {{"expression": "idiom phrase", "translation": "ë²ˆì—­", "dialogue_index": 7}}
        ],
        "similar_expressions": ["alternative 1", "alternative 2"],
        "scene_type": "humor|drama|tension|emotional|confrontation|sexy|surprising",
        "intro_hook": "Short hook in {target_language}"
      }}
    ]
  }}
  ```

  ---

  **FINAL CHECKLIST:**
  - âœ“ Expression: 3+ words, common, **CONTEXT-FREE** (learnable without knowing drama), copied exactly
  - âœ“ expression_translation: **LITERAL (ì§ì—­)** - straight word-by-word translation, no interpretation
  - âœ“ Scene: High-energy (funny/dramatic/tense/romantic)
  - âœ“ Context: ~{target_duration}s, complete story arc, expression in middle
  - âœ“ Clips: NO overlapping index ranges
  - âœ“ Narrations: 3-6 entries, spaced throughout, casual {target_language}
  - âœ“ Annotations: vocabulary (words) vs expression (idioms) - ZERO overlap
  - âœ“ Language rules: correct language for each field

  **Return ONLY valid JSON.**
  **No good expressions? Return: {{"expressions":[]}}**
