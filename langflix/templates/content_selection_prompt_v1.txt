You are analyzing subtitles from the TV show "{show_name}" to find engaging educational content.

**V2 MODE: You have BOTH source and target language subtitles - NO translation needed.**

---
**SOURCE LANGUAGE ({source_language}) DIALOGUES:**
{source_dialogues}

**TARGET LANGUAGE ({target_language}) DIALOGUES:**
{target_dialogues}
---

**YOUR MISSION:**
Select the most engaging, educational expression from this segment.
Focus on CONTENT QUALITY - translations are already provided.

**EXPRESSION COUNT:** Extract {min_expressions} to {max_expressions} expressions.
Each must have NON-OVERLAPPING time ranges and HIGH educational value.

---

## WHAT MAKES A GREAT SELECTION

**1. SCENE ENERGY** (Most Important)
- üòÇ HUMOROUS: Funny, witty, sarcastic moments
- üî• DRAMATIC: High tension, conflict, confrontation
- üòç ROMANTIC: Flirty, charming interactions
- üò≤ SURPRISING: Unexpected twists or reveals

**2. EXPRESSION VALUE**
- Multi-word phrases (3+ words): "get on my nerves", "cut to the chase"
- Phrasal verbs: "put up with", "come up with"
- Idiomatic expressions with non-obvious meanings
- NOT simple phrases like "I agree", "Thank you"

**3. REUSABILITY**
- Expression works in many contexts beyond this scene
- Native speakers use it regularly in everyday life
- Appropriate for level: {level_description}

---

## WHAT TO FIND (FROM SOURCE DIALOGUES)

1. **expression**: The key phrase to teach (from source language)
2. **expression_dialogue_index**: Which source dialogue line (0-indexed) contains it
3. **context_start_index**: First dialogue index for context clip
4. **context_end_index**: Last dialogue index for context clip

The expression and its translation will be looked up from the provided dialogues - you just identify WHERE.

---

## WHAT TO GENERATE

1. **title**: Catchy title in {target_language} (8-15 words)
2. **catchy_keywords**: 2-3 engaging phrases in {target_language} (3-6 words each)
3. **vocabulary_annotations**: 2-5 interesting words from source dialogues
4. **scene_type**: humor|drama|tension|emotional|witty|sexy|surprising
5. **similar_expressions**: 2-3 alternative expressions (in {source_language})
6. **intro_hook**: Short hook question in {target_language}

---

## CONTEXT DESIGN (Target: {target_duration} seconds)

**Build a Mini-Story:**
- **Beginning:** Setup, establish situation (context_start_index)
- **Middle:** Expression appears naturally (expression_dialogue_index)
- **End:** Reaction, closure (context_end_index)

**Rules:**
- Context should be approximately {target_duration} seconds
- Expression should NOT be at very beginning or very end
- Must include complete sentences at boundaries
- NO overlapping time ranges between different expressions

---

## OUTPUT FORMAT (JSON)

Respond with ONLY valid JSON, no markdown or explanations:

```json
{{
  "expressions": [
    {{
      "title": "[Catchy title in {target_language}]",
      "expression": "[Key phrase from source dialogues]",
      "expression_dialogue_index": 0,
      "context_start_index": 0,
      "context_end_index": 5,
      "catchy_keywords": [
        "[Keyword 1 in {target_language}]",
        "[Keyword 2 in {target_language}]"
      ],
      "vocabulary_annotations": [
        {{"word": "[word]", "dialogue_index": 0}}
      ],
      "similar_expressions": ["[alt 1]", "[alt 2]"],
      "scene_type": "humor",
      "intro_hook": "[Hook in {target_language}]"
    }}
  ]
}}
```

**FIELD EXPLANATIONS:**
- `expression_dialogue_index`: 0-indexed position in source_dialogues where expression appears
- `context_start_index`: First dialogue index to include in video clip
- `context_end_index`: Last dialogue index to include (inclusive)
- `vocabulary_annotations.dialogue_index`: Which source dialogue contains this word

---

## CHECKLIST

Before responding, verify:
- ‚úì Expression is substantive (3+ words, non-obvious meaning)
- ‚úì Scene has emotional energy (not boring/procedural)
- ‚úì Context indices create a complete mini-story
- ‚úì Context is approximately {target_duration} seconds
- ‚úì No overlapping time ranges if multiple expressions
- ‚úì All catchy_keywords and title are in {target_language}
- ‚úì expression_dialogue_index correctly points to the line containing the expression
- ‚úì vocabulary_annotations reference actual words from source dialogues

If no suitable expressions exist, respond with:
{{"expressions": []}}
